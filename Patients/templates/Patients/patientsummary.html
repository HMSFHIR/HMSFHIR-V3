<!-- patientsummary.html -->
{% extends "autht/main.html" %}
{% load static %}

{% block PageName %}Patient Summary{% endblock PageName %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <h2>Patient Summary</h2>
            
            <!-- Patient Basic Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h4>Patient Information</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Patient ID:</strong> {{ patient.patient_id }}</p>
                            <p><strong>Name:</strong> {{ patient.name }}</p>
                            <p><strong>Gender:</strong> {{ patient.gender }}</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>National ID:</strong> {{ patient.national_id }}</p>
                            <p><strong>Birth Date:</strong> {{ patient.birth_date }}</p>
                            <p><strong>Last Arrived:</strong> {{ patient.last_arrived }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Condition Details -->
            <div class="card mb-4">
                <div class="card-header">
                    <h4>Latest Condition Details</h4>
                </div>
                <div class="card-body">
                    {% if condition_details %}
                        <div class="row">
                            <div class="col-md-6">
                                <p><strong>ID:</strong> {{ condition_details.id }}</p>
                                <p><strong>Clinical Status:</strong> {{ condition_details.clinical_status }}</p>
                                <p><strong>Verification Status:</strong> {{ condition_details.verification_status }}</p>
                                <p><strong>Diagnosis:</strong> {{ condition_details.diagnosis }}</p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>Severity:</strong> {{ condition_details.severity }}</p>
                                <p><strong>Onset:</strong> {{ condition_details.onset }}</p>
                                <p><strong>Recorded Date:</strong> {{ condition_details.recorded_date }}</p>
                                <p><strong>Recorder:</strong> {{ condition_details.recorder }}</p>
                            </div>
                        </div>
                    {% else %}
                        <p class="text-muted">No condition details available</p>
                    {% endif %}
                </div>
            </div>

            <!-- Appointments -->
            <div class="card mb-4">
                <div class="card-header">
                    <h4>Appointments</h4>
                </div>
                <div class="card-body">
                    {% if appointments %}
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Practitioner</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for appointment in appointments %}
                                    <tr>
                                        <td>{{ appointment.appointment_date }}</td>
                                        <td>Dr. {{ appointment.practitioner.name }}</td>
                                        <td>{{ appointment.status }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <p class="text-muted">No appointments found</p>
                    {% endif %}
                </div>
            </div>

            <!-- Medical Records -->
            <div class="card mb-4">
                <div class="card-header">
                    <h4>Medical Records</h4>
                </div>
                <div class="card-body">
                    {% if medical_records %}
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Description</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for record in medical_records %}
                                    <tr>
                                        <td>{{ record.recorded_date }}</td>
                                        <td>{{ record.diagnosis }}</td>
                                        <td>{{ record.type }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <p class="text-muted">No medical records found</p>
                    {% endif %}
                </div>
            </div>

            <!-- Additional Medical Information -->
            <div class="row">
                <!-- Medications -->
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5>Current Medications</h5>
                        </div>
                        <div class="card-body">
                            {% if medications %}
                                {% for medication in medications %}
                                    <div class="mb-2">
                                        <strong>{{ medication.medication_name }}</strong><br>
                                        <small>Dosage: {{ medication.dosage }}</small><br>
                                        <small>Start Date: {{ medication.start_date }}</small>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <p class="text-muted">No medications recorded</p>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Allergies -->
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5>Allergies</h5>
                        </div>
                        <div class="card-body">
                            {% if allergies %}
                                {% for allergy in allergies %}
                                    <div class="mb-2">
                                        <strong>{{ allergy.substance }}</strong><br>
                                        <small>Reaction: {{ allergy.reaction }}</small><br>
                                        <small>Severity: {{ allergy.severity }}</small>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <p class="text-muted">No allergies recorded</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-3">
                <a href="{% url 'PatientList' %}" class="btn btn-secondary">Back to Patient List</a>
                <a href="{% url 'EditPatient' patient.patient_id %}" class="btn btn-primary">Edit Patient</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}